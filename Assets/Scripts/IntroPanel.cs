using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using TMPro;
using System;

//handle navigation and animation of the intro panel
public class IntroPanel : MonoBehaviour
{
    [SerializeField] private Animator circleAnimator = null;
    [SerializeField] private Animator checkMarkAnimator = null;
    [SerializeField] private Animator protectedTextAnimator = null;
    [SerializeField] private Animator scanButtonAnimator = null;
    [SerializeField] private Animator hazardsAnimator = null;
    [SerializeField] private Animator introPanelAnimator = null;

    [SerializeField] private TextMeshProUGUI updateText = null;

    public Action OnRunScan;
    
    public void RunIntroAnimation()
    {
        StartCoroutine(IntroRoutine());
    }

    private IEnumerator IntroRoutine()
    {
        circleAnimator.SetTrigger("Intro");
        updateText.gameObject.SetActive(true);
        updateText.text = "Initializing magi-tection...";
        yield return new WaitForSeconds(1.5f);
        updateText.text = "Consulting digital wizards...";
        yield return new WaitForSeconds(1.5f);
        updateText.text = "Looking at ectoplasm...  ";
        yield return new WaitForSeconds(1.5f);
        updateText.text = "Stalling for time...";
        yield return new WaitForSeconds(1f);

        checkMarkAnimator.SetTrigger("Intro");
        circleAnimator.SetTrigger("Idle");

        updateText.gameObject.SetActive(false);

        yield return new WaitForSeconds(0.5f);
        protectedTextAnimator.SetTrigger("Intro");

        yield return new WaitForSeconds(0.5f);
        hazardsAnimator.SetTrigger("Intro");

        yield return new WaitForSeconds(0.5f);
        scanButtonAnimator.SetTrigger("Intro");

    }

    //called from UI
    public void OnClickRunScan()
    {
        SoundManager.Instance.PlayClickSound();
        introPanelAnimator.SetTrigger("FadeOut");
    }

    //called from animator
    public void FadeCompleted()
    {
        OnRunScan?.Invoke();
    }

    public void FadeInPanel()
    {
        introPanelAnimator.SetTrigger("FadeIn");
    }

}
